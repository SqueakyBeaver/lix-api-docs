<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nix: nix::ThreadPool Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nix
   &#160;<span id="projectnumber">2.93.0-dev</span>
   </div>
   <div id="projectbrief">Lix: A modern, delicious implementation of the Nix package manager; unstable internal interfaces</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classnix_1_1ThreadPool.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classnix_1_1ThreadPool-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nix::ThreadPool Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="thread-pool_8hh_source.html">thread-pool.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6e2f52f700fe7c64f90f2992c260d194" id="r_a6e2f52f700fe7c64f90f2992c260d194"><td class="memItemLeft" align="right" valign="top">typedef std::function&lt; void(<a class="el" href="structnix_1_1AsyncIoRoot.html">AsyncIoRoot</a> &amp;)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e2f52f700fe7c64f90f2992c260d194">work_t</a>)</td></tr>
<tr class="separator:a6e2f52f700fe7c64f90f2992c260d194"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae1c6eaa4ef0bb30482357e4ce7b82e3d" id="r_ae1c6eaa4ef0bb30482357e4ce7b82e3d"><td class="memItemLeft" align="right" valign="top"><a id="ae1c6eaa4ef0bb30482357e4ce7b82e3d" name="ae1c6eaa4ef0bb30482357e4ce7b82e3d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadPool</b> (const char *name, size_t maxThreads=0)</td></tr>
<tr class="separator:ae1c6eaa4ef0bb30482357e4ce7b82e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5571fa570c9a14533c5eea1df2410f3" id="r_ac5571fa570c9a14533c5eea1df2410f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5571fa570c9a14533c5eea1df2410f3">enqueueWithAio</a> (const <a class="el" href="#a6e2f52f700fe7c64f90f2992c260d194">work_t</a> &amp;t)</td></tr>
<tr class="separator:ac5571fa570c9a14533c5eea1df2410f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8646ca52c8f339d54a62b404d11746e6" id="r_a8646ca52c8f339d54a62b404d11746e6"><td class="memItemLeft" align="right" valign="top"><a id="a8646ca52c8f339d54a62b404d11746e6" name="a8646ca52c8f339d54a62b404d11746e6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>enqueue</b> (std::function&lt; void()&gt; t)</td></tr>
<tr class="separator:a8646ca52c8f339d54a62b404d11746e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ebd3cf6e13bbd896fed3bad8a0ea9b" id="r_a14ebd3cf6e13bbd896fed3bad8a0ea9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14ebd3cf6e13bbd896fed3bad8a0ea9b">process</a> ()</td></tr>
<tr class="separator:a14ebd3cf6e13bbd896fed3bad8a0ea9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90c438e93b6a4a0b0505a2d0482a608" id="r_aa90c438e93b6a4a0b0505a2d0482a608"><td class="memItemLeft" align="right" valign="top">kj::Promise&lt; Result&lt; void &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa90c438e93b6a4a0b0505a2d0482a608">processAsync</a> ()</td></tr>
<tr class="separator:aa90c438e93b6a4a0b0505a2d0482a608"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple thread pool that executes a queue of work items (lambdas). </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a6e2f52f700fe7c64f90f2992c260d194" name="a6e2f52f700fe7c64f90f2992c260d194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e2f52f700fe7c64f90f2992c260d194">&#9670;&#160;</a></span>work_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::function&lt;void(<a class="el" href="structnix_1_1AsyncIoRoot.html">AsyncIoRoot</a> &amp;) nix::ThreadPool::work_t) </td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An individual work item.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000031">Todo</a></b></dt><dd>use std::packaged_task? </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac5571fa570c9a14533c5eea1df2410f3" name="ac5571fa570c9a14533c5eea1df2410f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5571fa570c9a14533c5eea1df2410f3">&#9670;&#160;</a></span>enqueueWithAio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nix::ThreadPool::enqueueWithAio </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#a6e2f52f700fe7c64f90f2992c260d194">work_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enqueue a function to be executed by the thread pool. </p>

</div>
</div>
<a id="a14ebd3cf6e13bbd896fed3bad8a0ea9b" name="a14ebd3cf6e13bbd896fed3bad8a0ea9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ebd3cf6e13bbd896fed3bad8a0ea9b">&#9670;&#160;</a></span>process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nix::ThreadPool::process </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Execute work items until the queue is empty.</p>
<dl class="section note"><dt>Note</dt><dd>Note that work items are allowed to add new items to the queue; this is handled correctly.</dd></dl>
<p>Queue processing stops prematurely if any work item throws an exception. This exception is propagated to the calling thread. If multiple work items throw an exception concurrently, only one item is propagated; the others are printed on stderr and otherwise ignored. </p>

</div>
</div>
<a id="aa90c438e93b6a4a0b0505a2d0482a608" name="aa90c438e93b6a4a0b0505a2d0482a608"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90c438e93b6a4a0b0505a2d0482a608">&#9670;&#160;</a></span>processAsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kj::Promise&lt; Result&lt; void &gt; &gt; nix::ThreadPool::processAsync </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Like <code>process</code>, but async. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lix/libutil/<a class="el" href="thread-pool_8hh_source.html">thread-pool.hh</a></li>
<li>lix/libutil/<b>thread-pool.cc</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>nix</b></li><li class="navelem"><a class="el" href="classnix_1_1ThreadPool.html">ThreadPool</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
